<!--ç°å®ä¸–ç•ŒRPGé¦–é¡µ-->
<view class="container">
  <!-- ç”¨æˆ·è§’è‰²ä¿¡æ¯ -->
  <view class="character-info">
    <view class="character-avatar">
      <image src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" class="avatar-image"></image>
      <view class="level-badge">Lv.{{character.level || 1}}</view>
    </view>
    <view class="character-details">
      <text class="character-name">{{userInfo.nickName || currentUser.name || 'å†’é™©è€…'}}</text>
      <text class="character-class">{{character.class || 'æ–°æ‰‹'}}</text>
      <view class="friend-code-display" wx:if="{{currentUser.friendCode}}">
        <text class="friend-code-label">å¥½å‹ä»£ç :</text>
        <text class="friend-code-value">{{currentUser.friendCode}}</text>
      </view>
      <view class="exp-bar">
        <view class="exp-progress" style="width: {{character.expPercent || 0}}%"></view>
        <text class="exp-text">{{character.experience || 0}}/{{character.nextLevelExp || 100}} EXP</text>
      </view>
    </view>
  </view>

  <!-- ä»Šæ—¥ä»»åŠ¡ -->
  <view class="today-tasks">
    <view class="section-title">
      <text>ä»Šæ—¥ä»»åŠ¡</text>
      <text class="task-count">{{todayTasks.length || 0}}/5</text>
    </view>
    <view class="task-list">
      <view class="task-item" wx:for="{{todayTasks}}" wx:key="id">
        <view class="task-icon {{item.completed ? 'completed' : ''}}">
          <text>{{item.completed ? 'âœ“' : 'â—‹'}}</text>
        </view>
        <view class="task-content">
          <text class="task-title">{{item.title}}</text>
          <text class="task-reward">+{{item.experience}}EXP</text>
        </view>
      </view>
      <view class="add-task" bindtap="navigateToTasks">
        <text>+ æ·»åŠ æ–°ä»»åŠ¡</text>
      </view>
    </view>
  </view>

  <!-- ä¹ æƒ¯æ‰“å¡ -->
  <view class="habits-section">
    <view class="section-title">
      <text>ä¹ æƒ¯æ‰“å¡</text>
      <text class="habit-streak">è¿ç»­{{maxStreak || 0}}å¤©</text>
    </view>
    <view class="habit-list">
      <view class="habit-item" wx:for="{{todayHabits}}" wx:key="id">
        <view class="habit-icon {{item.completed ? 'completed' : ''}}" bindtap="toggleHabit" data-id="{{item.id}}">
          <text>{{item.completed ? 'âœ“' : 'â—‹'}}</text>
        </view>
        <text class="habit-name">{{item.name}}</text>
        <text class="habit-streak">{{item.streak}}å¤©</text>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions">
    <view class="action-button" bindtap="navigateToCharacter">
      <text class="action-icon">ğŸ‘¤</text>
      <text class="action-text">è§’è‰²</text>
    </view>
    <view class="action-button" bindtap="navigateToTasks">
      <text class="action-icon">ğŸ“‹</text>
      <text class="action-text">ä»»åŠ¡</text>
    </view>
    <view class="action-button" bindtap="navigateToHabits">
      <text class="action-icon">ğŸ¯</text>
      <text class="action-text">ä¹ æƒ¯</text>
    </view>
    <view class="action-button" bindtap="navigateToRewards">
      <text class="action-icon">ğŸ†</text>
      <text class="action-text">å¥–åŠ±</text>
    </view>
    <view class="action-button" bindtap="navigateToSocial">
      <text class="action-icon">ğŸ‘¥</text>
      <text class="action-text">ç¤¾äº¤</text>
    </view>
    <view class="action-button" bindtap="navigateToStory">
      <text class="action-icon">ğŸ“–</text>
      <text class="action-text">æ•…äº‹</text>
    </view>
    <view class="action-button ai-button" bindtap="navigateToAITasks">
      <text class="action-icon">ğŸ¤–</text>
      <text class="action-text">AIæ¨è</text>
      <text class="ai-badge">GPT</text>
    </view>
    <view class="action-button collection-button" bindtap="navigateToItemCollection">
      <text class="action-icon">ğŸ’</text>
      <text class="action-text">æˆ‘çš„æ”¶è—</text>
      <text class="collection-badge">NEW</text>
    </view>
    <view class="action-button story-button" bindtap="navigateToDynamicStory">
      <text class="action-icon">ğŸ­</text>
      <text class="action-text">å†’é™©æ—¥è®°</text>
      <text class="story-badge">AI</text>
    </view>
  </view>


</view>