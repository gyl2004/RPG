<!--ä»»åŠ¡é¡µé¢-->
<view class="tasks-container">
  <!-- ä»»åŠ¡ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="stats-card">
      <text class="stats-title">ä»»åŠ¡æ¦‚è§ˆ</text>
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-number">{{statistics.total || 0}}</text>
          <text class="stat-label">æ€»ä»»åŠ¡</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.completed || 0}}</text>
          <text class="stat-label">å·²å®Œæˆ</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.inProgress || 0}}</text>
          <text class="stat-label">è¿›è¡Œä¸­</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.pending || 0}}</text>
          <text class="stat-label">å¾…å¼€å§‹</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions">
    <rpg-button
      type="primary"
      text="åˆ›å»ºæ–°ä»»åŠ¡"
      bindtap="goToCreateTask"
    />
    <rpg-button
      type="secondary"
      text="ğŸ¤– AIæ¨è"
      bindtap="goToAITasks"
    />
  </view>

  <!-- ä»»åŠ¡è¿‡æ»¤ -->
  <view class="filter-tabs">
    <view
      class="filter-tab {{currentFilter === 'all' ? 'active' : ''}}"
      data-filter="all"
      bindtap="switchFilter"
    >
      <text class="tab-text">å…¨éƒ¨</text>
    </view>
    <view
      class="filter-tab {{currentFilter === 'pending' ? 'active' : ''}}"
      data-filter="pending"
      bindtap="switchFilter"
    >
      <text class="tab-text">å¾…å¼€å§‹</text>
    </view>
    <view
      class="filter-tab {{currentFilter === 'in_progress' ? 'active' : ''}}"
      data-filter="in_progress"
      bindtap="switchFilter"
    >
      <text class="tab-text">è¿›è¡Œä¸­</text>
    </view>
    <view
      class="filter-tab {{currentFilter === 'completed' ? 'active' : ''}}"
      data-filter="completed"
      bindtap="switchFilter"
    >
      <text class="tab-text">å·²å®Œæˆ</text>
    </view>
  </view>

  <!-- ä»»åŠ¡åˆ—è¡¨ -->
  <view class="tasks-list">
    <view
      class="task-card"
      wx:for="{{tasks}}"
      wx:key="id"
      data-task-id="{{item.id}}"
      bindtap="viewTaskDetail"
    >
      <view class="task-header">
        <text class="task-title">{{item.title}}</text>
        <view class="task-status {{item.status}}">
          <text class="status-text">{{item.status === 'pending' ? 'å¾…å¼€å§‹' : item.status === 'in_progress' ? 'è¿›è¡Œä¸­' : item.status === 'completed' ? 'å·²å®Œæˆ' : 'å·²å¤±è´¥'}}</text>
        </view>
      </view>

      <text class="task-description" wx:if="{{item.description}}">{{item.description}}</text>

      <view class="task-meta">
        <view class="meta-item">
          <text class="meta-icon">{{categories[item.category] ? categories[item.category].icon : 'ğŸ“‹'}}</text>
          <text class="meta-text">{{categories[item.category] ? categories[item.category].name : item.category}}</text>
        </view>
        <view class="meta-item">
          <text class="meta-icon">{{difficulties[item.difficulty] ? difficulties[item.difficulty].icon : 'â­'}}</text>
          <text class="meta-text">{{difficulties[item.difficulty] ? difficulties[item.difficulty].name : item.difficulty}}</text>
        </view>
        <view class="meta-item">
          <text class="meta-icon">â°</text>
          <text class="meta-text">{{item.estimatedTime}}åˆ†é’Ÿ</text>
        </view>
        <view class="meta-item" wx:if="{{item.deadline}}">
          <text class="meta-icon">ğŸ“…</text>
          <text class="meta-text">{{item.deadline}}</text>
        </view>
      </view>

      <view class="task-rewards" wx:if="{{item.rewards}}">
        <text class="reward-item">â­ {{item.rewards.experience}}</text>
        <text class="reward-item">ğŸ’° {{item.rewards.coins}}</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{tasks.length === 0 && !loading}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-title">æš‚æ— ä»»åŠ¡</text>
      <text class="empty-desc">åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œå¼€å§‹å†’é™©ä¹‹æ—…å§ï¼</text>
      <rpg-button
        type="primary"
        text="åˆ›å»ºä»»åŠ¡"
        size="small"
        bindtap="goToCreateTask"
      />
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-overlay">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>
